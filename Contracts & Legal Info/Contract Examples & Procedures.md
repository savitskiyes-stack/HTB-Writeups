Тип	Предоставленная информация
Blackbox	MinimalПредоставляется только необходимая информация, такая как IP-адреса и домены.
Greybox	ExtendedВ этом случае нам предоставляется дополнительная информация, такая как конкретные URL-адреса, имена хостов, подсети и тому подобное.
Whitebox	MaximumЗдесь нам раскрывается вся информация. Это дает нам внутреннее представление о всей структуре, что позволяет подготовить атаку, используя внутренние данные. Нам могут быть предоставлены подробные конфигурации, учетные данные администратора, исходный код веб-приложения и т. д.
Red-Teaming	Может включать в себя, помимо прочего, физические испытания и социальную инженерию. Может сочетаться с любым из вышеперечисленных типов.
Purple-Teaming	Его можно сочетать с любым из вышеперечисленных типов. Однако он ориентирован на тесное взаимодействие с защитниками.




	Мера предосторожности
☐	Получите письменное согласие владельца или уполномоченного представителя тестируемого компьютера или сети.
☐	Проводите тестирование исключительно в рамках полученного согласия и соблюдайте все указанные ограничения.
☐	Примите меры для предотвращения нанесения ущерба тестируемым системам или сетям.
☐	Не получайте доступ, не используйте и не разглашайте персональные данные или любую другую информацию, полученную в ходе тестирования, без разрешения.
☐	Не перехватывайте электронные сообщения без согласия одной из сторон, участвующих в сообщении.
☐	Не проводите тестирование систем или сетей, подпадающих под действие Закона о переносимости и подотчетности медицинского страхования (HIPAA), без надлежащего разрешения.


Этапы (или стадии) процесса тестирования на проникновение включают в себя последовательные шаги, которые выполняет тестировщик для достижения цели. Обычно их можно разбить так:

Планирование и подготовка — определение целей, правил и методов тестирования.

Сбор информации — сбор данных о целевой системе или сети.

Анализ уязвимостей — поиск слабых мест и уязвимостей.

Эксплуатация — попытки использовать найденные уязвимости для проникновения.

Постэксплуатация — оценка уровня доступа и сбор дополнительных данных.

Отчетность — подготовка отчета о выполненной работе и найденных уязвимостях.






Этап	Описание
1. Pre-Engagement	Первым шагом является создание всех необходимых документов на этапе предварительного взаимодействия, обсуждение целей оценки и уточнение любых вопросов.
2. Information Gathering	После завершения подготовительных мероприятий мы изучаем существующий веб-сайт компании, который нам поручено оценить. Мы определяем используемые технологии и изучаем, как функционирует веб-приложение.
3. Vulnerability Assessment	Обладая этой информацией, мы можем искать известные уязвимости и исследовать сомнительные особенности, которые могут допускать непредусмотренные действия.
4. Exploitation	После обнаружения потенциальных уязвимостей мы подготавливаем код эксплойта, инструменты и среду, а затем тестируем веб-сервер на наличие этих потенциальных уязвимостей.
5. Post-Exploitation	После успешного взлома целевого сервера мы переходим к сбору информации и проводим внутреннее исследование веб-сервера. Если на этом этапе мы обнаружим конфиденциальную информацию, мы попытаемся повысить свои привилегии (в зависимости от системы и конфигурации).
6. Lateral Movement	Если в зону действия попадают другие серверы и хосты во внутренней сети, мы пытаемся перейти по сети и получить доступ к другим хостам и серверам, используя собранную информацию.
7. Proof-of-Concept	Мы создаём прототип, доказывающий существование этих уязвимостей, и потенциально даже автоматизируем отдельные шаги, которые приводят к их срабатыванию.
8. Post-Engagement	Наконец, документация завершается и представляется клиенту в виде официального отчета. После этого мы можем провести совещание по обсуждению отчета, чтобы уточнить любые моменты, касающиеся нашего тестирования или результатов, и оказать необходимую поддержку персоналу, ответственному за устранение выявленных недостатков.



Документ	Время для сотворения
1. Non-Disclosure Agreement( NDA)	AfterПервый контакт
2. Scoping Questionnaire	BeforeПредварительная встреча
3. Scoping Document	DuringПредварительная встреча
4. Penetration Testing Proposal( Contract/Scope of Work( SoW))	DuringПредварительная встреча
5. Rules of Engagement( RoE)	Beforeстартовое совещание
6. Contractors Agreement(Физическое обследование)	Beforeстартовое совещание
7. Reports	Duringи afterпроведенный тест на проникновение



АНКЕТА ДЛЯ КЛИЕНТА 

☐ Внутренняя оценка уязвимости	☐ Оценка внешней уязвимости
☐ Тест на внутреннее проникновение	☐ Испытание на внешнее проникновение
☐ Оценка безопасности беспроводной сети	☐ Оценка безопасности приложения
☐ Оценка физической безопасности	☐ Оценка социальной инженерии
☐ Оценка «красной команды»	☐ Оценка безопасности веб-приложений

ДОП

В каждом из этих разделов анкета должна позволять клиенту более точно указать требуемую оценку. Нужна ли им оценка веб-приложения или мобильного приложения? Проверка безопасности кода? Должен ли внутренний тест на проникновение быть методом «черного ящика» и полузащищенным? Нужна ли им только оценка фишинга в рамках оценки социальной инженерии или также оценка вишинговых звонков? Это наш шанс объяснить глубину и широту наших услуг, убедиться, что мы понимаем потребности и ожидания клиента, и гарантировать, что мы сможем адекватно провести необходимую ему оценку.


Сколько ожидаемых ведущих будет в прямом эфире?	
Сколько диапазонов IP-адресов/CIDR находится в зоне действия?	
Сколько доменов/поддоменов находится в зоне действия?	
Сколько беспроводных SSID находится в зоне действия?	
Сколько веб/мобильных приложений? Если тестирование проводится с аутентификацией, сколько ролей (обычный пользователь, администратор и т. д.)?	
Для оценки фишинговой атаки, сколько пользователей будет целью атаки? Предоставит ли клиент список, или нам потребуется собрать этот список с помощью OSINT?	
Если клиент запрашивает физическую оценку, то сколько мест она должна охватить? Если в сферу действия входит несколько объектов, то географически ли они распределены?	
Какова цель оценки "красной команды"? Входят ли в рамки оценки какие-либо действия (например, фишинг или атаки на физическую безопасность)?	
Требуется ли отдельная оценка безопасности Active Directory?	
Будет ли тестирование сети проводиться анонимным пользователем сети или стандартным пользователем домена?	
Нужно ли обходить систему контроля доступа к сети (NAC)?



Контракт - Контрольный список

Контрольно-пропускной пункт	Описание
☐ NDA	Соглашение о неразглашении (NDA) — это договор о сохранении конфиденциальности между заказчиком и подрядчиком в отношении всей письменной или устной информации, касающейся заказа/проекта. Подрядчик обязуется рассматривать всю конфиденциальную информацию, доведенную до его сведения, как строго конфиденциальную, даже после завершения заказа/проекта. Кроме того, в соглашении должны быть оговорены любые исключения из принципа конфиденциальности, возможность передачи прав и обязанностей, а также договорные штрафные санкции. Соглашение о неразглашении должно быть подписано до начала совещания или, самое позднее, во время совещания, до начала детального обсуждения какой-либо информации.
☐ Goals	Цели — это этапы, которые необходимо достичь в ходе выполнения заказа/проекта. В этом процессе постановка целей начинается с определения значимых целей, а затем продолжается более детальными и мелкими задачами.
☐ Scope	Обсуждаются и определяются отдельные компоненты, подлежащие тестированию. К ним могут относиться домены, диапазоны IP-адресов, отдельные хосты, конкретные учетные записи, системы безопасности и т. д. Наши клиенты могут ожидать, что мы сами выясним тот или иной момент. Однако правовая основа для тестирования отдельных компонентов здесь имеет наивысший приоритет.
☐ Penetration Testing Type	При выборе типа тестирования на проникновение мы представляем отдельные варианты и объясняем преимущества и недостатки. Поскольку мы уже знаем цели и масштабы задач наших клиентов, мы можем и должны дать рекомендацию относительно того, что мы советуем, и обосновать ее соответствующим образом. Какой тип тестирования будет использован в итоге, решает клиент.
☐ Methodologies	Примеры: OSSTMM, OWASP, автоматизированный и ручной неаутентифицированный анализ внутренних и внешних сетевых компонентов, оценка уязвимостей сетевых компонентов и веб-приложений, векторизация угроз уязвимостей, их проверка и эксплойт, а также разработка эксплойтов для облегчения методов обхода защиты.
☐ Penetration Testing Locations	Внешнее: Удаленное (через защищенный VPN) и/или Внутреннее: Внутреннее или Удаленное (через защищенный VPN)
☐ Time Estimation	Для оценки времени нам необходимы даты начала и окончания тестирования на проникновение. Это обеспечивает точное временное окно для проведения теста и помогает нам спланировать процедуру. Также крайне важно четко определить продолжительность временных окон для каждой фазы атаки, таких как эксплуатация, постэксплуатация и горизонтальное перемещение. Эти этапы могут проводиться как в рабочее, так и в нерабочее время. При тестировании вне рабочего времени основное внимание уделяется решениям и системам безопасности, которые должны противостоять нашим атакам.
☐ Third Parties	Что касается третьих сторон, необходимо определить, через каких сторонних поставщиков наш клиент получает услуги. Это могут быть облачные провайдеры, интернет-провайдеры и другие хостинг-провайдеры. Наш клиент должен получить письменное согласие от этих поставщиков, подтверждающее их согласие и осведомленность о том, что определенные части их услуг будут подвергнуты имитации хакерской атаки. Также настоятельно рекомендуется потребовать от подрядчика переслать нам полученное от третьих сторон разрешение, чтобы мы имели фактическое подтверждение того, что это разрешение действительно было получено.
☐ Evasive Testing	Тестирование на обход системы безопасности — это проверка способности обходить и преодолевать защищенный трафик и системы безопасности в инфраструктуре заказчика. Мы ищем методы, позволяющие получить информацию о внутренних компонентах и ​​атаковать их. Это зависит от того, хочет ли наш подрядчик, чтобы мы использовали такие методы, или нет.
☐ Risks	Мы также должны проинформировать нашего клиента о рисках, связанных с проведением тестов, и о возможных последствиях. Исходя из рисков и их потенциальной серьезности, мы сможем совместно установить ограничения и принять определенные меры предосторожности.
☐ Scope Limitations & Restrictions	Также крайне важно определить, какие серверы, рабочие станции или другие сетевые компоненты необходимы для надлежащего функционирования клиента и его клиентов. Мы должны избегать их использования и не должны оказывать на них дальнейшего влияния, поскольку это может привести к критическим техническим ошибкам, которые также могут повлиять на клиентов нашего клиента в процессе работы.
☐ Information Handling	HIPAA, PCI, HITRUST, FISMA/NIST и т. д.
☐ Contact Information	Для сбора контактной информации нам необходимо составить список, включающий имя, должность, название должности, адрес электронной почты, номер телефона, рабочий номер телефона и порядок приоритета обработки каждого сотрудника.
☐ Lines of Communication	Также необходимо задокументировать, какие каналы связи используются для обмена информацией между клиентом и нами. Это может включать электронную переписку, телефонные звонки или личные встречи.
☐ Reporting	Помимо структуры отчета, обсуждаются также любые специфические требования заказчика, которые он должен содержать. Кроме того, мы уточняем, как должен осуществляться процесс составления отчета и желательно ли его презентация.
☐ Payment Terms	В заключение разъясняются цены и условия оплаты.





Правила взаимодействия — контрольный список
Контрольно-пропускной пункт	Содержание
☐ Introduction	Описание данного документа.
☐ Contractor	Название компании, полное имя подрядчика, должность.
☐ Penetration Testers	Название компании, полные имена специалистов по тестированию на проникновение.
☐ Contact Information	Почтовые адреса, адреса электронной почты и номера телефонов всех клиентов и специалистов по тестированию на проникновение.
☐ Purpose	Описание цели проведенного теста на проникновение.
☐ Goals	Описание целей, которые должны быть достигнуты с помощью тестирования на проникновение.
☐ Scope	Все IP-адреса, доменные имена, URL-адреса или диапазоны CIDR.
☐ Lines of Communication	Онлайн-конференции, телефонные звонки, личные встречи или электронная почта.
☐ Time Estimation	Даты начала и окончания.
☐ Time of the Day to Test	Время суток для проведения тестирования.
☐ Penetration Testing Type	Внешнее/внутреннее тестирование на проникновение/оценка уязвимостей/социальная инженерия.
☐ Penetration Testing Locations	Описание способа установления соединения с клиентской сетью.
☐ Methodologies	OSSTMM, PTES, OWASP и другие.
☐ Objectives / Flags	Пользователи, конкретные файлы, конкретная информация и прочее.
☐ Evidence Handling	Шифрование, защищенные протоколы
☐ System Backups	Конфигурационные файлы, базы данных и другие.
☐ Information Handling	Надежное шифрование данных
☐ Incident Handling and Reporting	Обстоятельства для установления контакта, прерывания пентестинга, типы отчетов
☐ Status Meetings	Частота встреч, даты, время, участвующие стороны.
☐ Reporting	Тип, целевая аудитория, фокус
☐ Retesting	Даты начала и окончания
☐ Disclaimers and Limitation of Liability	Повреждение системы, потеря данных.
☐ Permission to Test	Подписанный контракт, соглашение с подрядчиком



