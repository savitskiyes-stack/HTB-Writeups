### Обход брандмауэров и систем обнаружения/предотвращения вторженийsudo nmap -sV -Pn -n 10.129.23.205sudo использует -sS SYN-скан (-sS по умолчанию), который скрытный (не завершает соединение)TCP-пакеты возвращаются с флагом RST тогда как ICMP-пакеты могут содержать различные типы кодов ошибок:Сеть недоступнаСеть запрещенаХост недоступенХозяин запрещенПорт недоступенПрото недостижимыйМетод сканирования TCP ACK ( ) в Nmap -sA гораздо сложнее отфильтровать для брандмауэров и систем IDS/IPS&nbsp;чем обычные -sS сканирования SYN ( ) или Connect ( sT), поскольку они отправляют только TCP-пакет с ACK флагомКогда порт закрыт или открыт, хост должен ответить флагом RST. В отличие от исходящих соединений, все попытки подключения (с SYN флагом) из внешних сетей обычно блокируются брандмауэрамиСИН-сканОбход брандмауэров и систем обнаружения/sudo nmap 10.129.2.28 -p 21,22,25 -sS -Pn -n --disable-arp-ping --packet-traceACK-сканированиеОбход брандмауэров и систем обнаружения/sudo nmap 10.129.2.28 -p 21,22,25 -sA -Pn -n --disable-arp-ping --packet-trace--disable-arp-ping--packet-trace###### Обнаружение систем обнаружения/предотвращения вторжений (IDS/IPS)Сканирование с использованием приманокОбход брандмауэров и систем обнаруженияsudo nmap 10.129.2.28 -p 80 -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5-D RND:5   Генерирует пять случайных IP-адресов, указывающих на исходный IP-адрес, с которого поступает соединение.Но для реальных условий нужно перечислять ip чтобы они точно были доступными:sudo nmap -D 8.8.8.8,1.1.1.1,4.2.2.2,ME -p- -sS <цель\_IP>Проверка правила брандмауэраsudo nmap 10.129.2.28 -n -Pn -p445 -OСканирование с использованием IP-адреса другого источникаsudo nmap 10.129.2.28 -n -Pn -p 445 -O -S 10.129.2.200 -e tun0DNS-проксированиеуказывать DNS-серверы ( --dns-server <ns>,<ns>). Этот метод может быть для нас принципиально важен, если мы находимся в демилитаризованной зоне ( DMZ)(Во внутренней сети). DNS-серверы компании обычно пользуются большим доверием, чем серверы из интернета. Так, например, мы могли бы использовать их для взаимодействия с хостами внутренней сетимы можем использовать TCP port 53в качестве исходного порта ( --source-port) для наших сканирований. Если администратор использует брандмауэр для управления этим портом и не фильтрует IDS/IPS должным образом, наши TCP-пакеты будут считаться доверенными и проходить дальше##### SYN-сканирование с DNS-портаsudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port 53SENT (0.0482s) TCP 10.10.14.2:53 > 10.129.2.28:50000 S ttl=58 id=27470 iplen=44  seq=4003923435 win=1024 <mss 1460>RCVD (0.0608s) TCP 10.129.2.28:50000 > 10.10.14.2:53 SA ttl=64 id=0 iplen=44  seq=540635485 win=64240 <mss 1460>Nmap scan report for 10.129.2.28Host is up (0.013s latency).PORT      STATE SERVICE50000/tcp open  ibm-db2MAC Address: DE:AD:00:00:BE:EF (Intel Corporate)Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds##### SYN-сканирование отфильтрованного портаsudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-traceStarting Nmap 7.80 ( https://nmap.org ) at 2020-06-21 22:50 CESTSENT (0.0417s) TCP 10.10.14.2:33436 > 10.129.2.28:50000 S ttl=41 id=21939 iplen=44  seq=736533153 win=1024 <mss 1460>SENT (1.0481s) TCP 10.10.14.2:33437 > 10.129.2.28:50000 S ttl=46 id=6446 iplen=44  seq=736598688 win=1024 <mss 1460>Nmap scan report for 10.129.2.28Host is up.PORT      STATE    SERVICE50000/tcp filtered ibm-db2Далее проверка на подключениеncat -nv --source-port 53 10.129.2.28 50000