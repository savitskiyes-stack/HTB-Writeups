Полный стелс скан tcp портов на цели(очень долго):
nmap sudo nmap 10.129.21.252 -p- --packet-trace -n --disable-arp-ping -Pn


Полный скан всех TCP портов на цели:
sudo nmap -p- -sS -Pn --reason 10.129.21.252


Перечисление имен хоста:
sudo nmap -sV -Pn -R 10.129.21.252


пример в выводе:
Service Info: Host: NIX-NMAP-DEFAULT


Сохранить результат(отчет) сканирования во всех форматах:
sudo nmap -p- -sS -Pn --reason 10.129.21.252 -oA target


Преобразовать xml в html:
xsltproc target.xml -o target.html


Сервисы и уязвимости на них:
sudo nmap -p22,80,110,139,143,445 --script vuln 10.129.22.47


Обход обнаружения выявление версии сервиса dns
sudo nmap -sU -sV -p53 --script dns* 10.129.2.48 (Если UDP)


Обход обнаружения выявление ОС сервера
sudo nmap -sV -Pn -n 10.129.23.205


определение хостов по списку
sudo nmap -sn -oA tnet -iL hosts.lst | grep for | cut -d" " -f5






+----------+-----------------------------------+-------------------------------------------------+
| Опция    | Описание                          | Пример использования                            |
+----------+-----------------------------------+-------------------------------------------------+
| -sS      | SYN-скан (быстрый, скрытный)      | sudo nmap -sS -p- <IP>                          |
| -sT      | TCP connect (полное соединение)   | nmap -sT -p80 <IP>                              |
| -sU      | UDP-скан (для UDP-сервисов)       | sudo nmap -sU -p53 <IP>                         |
| -p       | Указать порты (диапазон/список)  | -p 1-1000 или -p 22,80,443                       |
| -Pn      | Без пинга (для обхода firewall)   | sudo nmap -Pn -sS <IP>                          |
| -n       | Без DNS-разрешения (ускорение)    | nmap -n -p- <IP>                                |
| -O       | OS fingerprinting (определить ОС) | sudo nmap -O <IP>                               |
| -sV      | Определить версии сервисов        | sudo nmap -sV -p22,80 <IP>                      |
| -sC      | Запустить default NSE-скрипты     | sudo nmap -sC -p- <IP>                          |
| -v       | Verbose (подробный вывод)         | nmap -v -sS <IP>                                |
| -A       | Агрессивный скан (все: -O -sV -sC)| sudo nmap -A <IP>                               |
| -oN      | Сохранить вывод в файл            | nmap -oN scan.txt <IP>                          |
| -f       | Фрагментация пакетов (обход IPS)  | sudo nmap -f -sS <IP>                           |
| -D       | Decoy (маскировка под другие IP)  | sudo nmap -D RND:5 <IP>                         |
| --reason | Показать причины состояний       | nmap --reason -p- <IP>                           |
+----------+-----------------------------------+-------------------------------------------------+