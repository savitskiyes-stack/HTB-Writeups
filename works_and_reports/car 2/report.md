Дата тестирования: 02 февраля 2026
Тестировщик: [Евгений / Junior Penetration Tester]
1. Executive Summary (Краткое резюме)
В ходе тестирования была успешно скомпрометирована целевая машина GettingStarted.htb (IP: 10.129.20.166).

- Начальный доступ получен через уязвимость в CMS GetSimple 3.3.15 (CVE-2019-11231).
- Эскалация привилегий выполнена за счёт неправильной конфигурации sudo (NOPASSWD: /usr/bin/php).
- Получен полный root-доступ к системе.

Общий уровень риска: Critical
Рекомендуется в кратчайшие сроки устранить выявленные проблемы.      





2. Область тестирования (Scope)

- Целевой хост: 10.129.20.166 (gettingstarted.htb)
- Порты: 22 (SSH), 80 (HTTP)
- Тестирование проводилось в рамках HTB Academy с разрешения лаборатории.





3. Методология
Использовался стандартный подход PTES / OWASP Testing Guide:

- Reconnaissance & Enumeration
- Vulnerability Identification
- Exploitation
- Post-Exploitation & Privilege Escalation


+---+-------------------------------------------------+----------+---------------------------------+-------------------------------+
| № | Уязвимость                                      | Уровень  | CVE / Источник                  | Вектор атаки                  |
+---+-------------------------------------------------+----------+---------------------------------+-------------------------------+
| 1 | Открытые директории с листингом (/data/, /backups/) | High     | Misconfiguration                | Directory Listing             |
| 2 | Утечка учётных данных администратора            | Critical | /data/users.xml                 | Information Disclosure        |
| 3 | RCE в GetSimple CMS 3.3.15                      | Critical | CVE-2019-11231                  | Unauthenticated Code Execution |
| 4 | Неправильная конфигурация sudo                  | Critical | sudo NOPASSWD: /usr/bin/php     | Privilege Escalation          |
+---+-------------------------------------------------+----------+---------------------------------+-------------------------------+





5. Хронология атаки (Exploitation Steps)

Разведка
Nmap + http-enum → обнаружены /admin/, /data/, /backups/
Gobuster → подтверждены открытые директории

Утечка данных curl http://10.129.20.166/data/users.xml → получен хэш пароля администратора
Получение учётных данных
Логин: admin
Пароль: admin (SHA1-хэш успешно взломан)
RCE через CMS
Вошли в админ-панель /admin/
Отредактировали файл theme/Innovation/template.php
Вставили reverse shell payload
Получили шелл от имени пользователя www-data

Привилегированная эскалацияsudo -l показал право запуска /usr/bin/php без пароля
Выполнили:
sudo /usr/bin/php -r 'pcntl_exec("/bin/sh", array("-i"));'

Получен root-доступ.






6. Рекомендации по устранению
Критично (исправить в течение 24–48 часов):

- Обновить GetSimple CMS минимум до последней версии (3.3.19+).
- Удалить или закрыть директорию /data/ от чтения извне (chmod 750 + .htaccess).
- Убрать NOPASSWD для /usr/bin/php у пользователя www-data.
- Включить open_basedir и disable_functions в php.ini.



Средний приоритет:

- Отключить directory listing в Apache (Options -Indexes).
- Внедрить Web Application Firewall (WAF) или ModSecurity.
- Регулярно обновлять все компоненты (Apache, PHP, CMS).






7. Заключение
Машина GettingStarted была полностью скомпрометирована за счёт классических ошибок конфигурации и устаревшего ПО.
Получен root-доступ, что демонстрирует высокий уровень риска для реальной инфраструктуры.
Готов обсудить отчёт, ответить на вопросы и помочь с исправлением найденных проблем.
С уважением,

Евгений Е.С.
Junior Penetration Tester





